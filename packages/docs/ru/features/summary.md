# Саммари

Саммари реализован через комбинацию 2 фичей: Доп.блока и код-блока.

## Как это работает:

1. Убедиться, что в рычагах включены код-блоки "Trim history to summary"
   ![](/summary-levers.png)
2. В нужный момент РП запустить генерацию саммари
   ![](/summary-message.png){width=300px}
3. ...PROFIT

## Что происходит под капотом

В момент, когда нажимается кнопка для генерации доп.блока "summary", выполняется промпт Summarizer

![](/summary-prompt.png)

::: info Ворнинг
Не забудь настроить прокси для этого промпта
:::

После того как он отработал, во всех последующих запросах история будет обрезаться до ближайшего сообщения с саммари через код-блок

![](/code-block-summary.png){width=300px}

Внутри промпта начнет работать переменная `{{external:summary}}`, в которую попадет последний саммари 

![](/public/summary-variable.png)

При последующих выполнениях саммари, он будет брать предыдущий и дописывать к нему новые главы.

Поведение регулируется промптом, спасибо [анону за сборник](https://rentry.co/summarize_0125)
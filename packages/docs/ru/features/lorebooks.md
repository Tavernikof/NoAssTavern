# Лорбуки

Лорбуки — это базы знаний, предоставляющие контекст вашим AI-персонажам.

## Обзор

Лорбук содержит **записи**, которые автоматически включаются в промпт при обнаружении соответствующих ключевых слов в беседе.

## Как работают лорбуки

1. Вы создаёте записи с ключевыми словами и содержимым
2. Во время чата система сканирует сообщения на ключевые слова
3. Совпавшие записи добавляются в контекст ИИ
4. ИИ использует эту информацию в своих ответах

## Создание лорбука

1. Перейдите на страницу **Персонажи** или **Промпты**
2. Нажмите **Создать лорбук**
3. Добавьте записи с:
   - **Ключевые слова**: Слова, активирующие запись
   - **Содержимое**: Информация для включения
   - **Стратегия**: Как обрабатывать совпадения
4. Сохраните лорбук

## Записи лорбука

Каждая запись содержит:

| Поле | Описание |
|-------|-------------|
| **Ключевые слова** | Слова, активирующие включение |
| **Содержимое** | Текст, добавляемый в промпт |
| **Стратегия** | Поведение при совпадении |
| **Глубина** | Как далеко назад сканировать |
| **Условия** | Продвинутые правила совпадения |

## Стратегии совпадения

### Normal

- Запись включается при нахождении ключевых слов
- Стандартное поведение для большинства случаев

### Constant

- Запись включается всегда
- Используйте для необходимой информации о мире
- Совпадение ключевых слов не требуется

### Vectorized

- Использует семантическое сходство
- Более гибкий, чем точные ключевые слова
- Лучше для связанных концепций

## Условия

Управляйте совпадением записей с помощью условий:

| Условие | Поведение |
|-----------|----------|
| **Any** | Совпадение, если найдено ЛЮБОЕ ключевое слово |
| **All** | Совпадение только если найдены ВСЕ ключевые слова |
| **Not Any** | Совпадение, если НЕ найдено НИ ОДНОГО ключевого слова |
| **Not All** | Совпадение, если найдены НЕ ВСЕ ключевые слова |

## Настройка глубины

Глубина контролирует, сколько сообщений сканируется:

- **Глубина 0**: Только текущее сообщение
- **Глубина 5**: Последние 5 сообщений
- **Без ограничений**: Вся беседа

Большая глубина захватывает больше контекста, но использует больше токенов.

## Прикрепление лорбуков

### К персонажам

1. Редактируйте персонажа
2. Найдите раздел **Лорбук**
3. Выберите или создайте лорбук
4. Сохраните персонажа

Лорбук активируется, когда этот персонаж участвует в чате.

### К чатам

1. Откройте настройки чата
2. Найдите раздел **Лорбуки**
3. Добавьте лорбуки к чату
4. Сохраните настройки

Эти лорбуки активны только для этого конкретного чата.

## Примеры записей

### Предыстория персонажа

```text
Ключевые слова: детство, прошлое, история, вырос
Содержимое: {{char}} вырос в маленькой рыбацкой деревне на побережье. Его отец был рыбаком, который пропал в море, когда {{char}} был маленьким.
Стратегия: Normal
```

### Информация о локации

```
Ключевые слова: таверна, трактир, заведение
Содержимое: «Ржавый якорь» — популярная таверна в портовом районе. Здесь подают крепкий эль и свежие морепродукты. Владелец — отставной моряк по имени Старина Пит.
Стратегия: Normal
```

### Правило мира (Constant)

```
Ключевые слова: (не требуются)
Содержимое: В этом мире нет электричества или современных технологий. Люди используют свечи, лошадей и парусные корабли.
Стратегия: Constant
```

## Импорт лорбуков

Вы можете импортировать лорбуки из:

- Карточек персонажей (встроенные лорбуки)
- JSON-файлов лорбуков
- Других персонажей в NoassTavern

## Советы по созданию хороших лорбуков

1. **Будьте конкретны с ключевыми словами**: Используйте характерные слова
2. **Держите записи сфокусированными**: Одна тема на запись
3. **Используйте constant умеренно**: Они всегда используют токены
4. **Тестируйте ключевые слова**: Убедитесь, что они срабатывают правильно
5. **Избегайте пересекающихся записей**: Предотвращает дублирование информации

## Следующие шаги

- [Персонажи](./characters.md) — Прикрепление лорбуков к персонажам
- [Чаты](./chats.md) — Использование лорбуков в беседах
